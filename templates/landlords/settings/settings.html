{% extends "landlords/landlord_base.html" %}

{% block title %}Account Settings{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto">
    <!-- Header -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-900">Account Settings</h1>
        <p class="text-gray-600">Manage your account preferences and security</p>
    </div>

    <!-- Tabs -->
    <div class="border-b border-gray-200 mb-6">
        <nav class="-mb-px flex space-x-8">
            <a href="#account" class="border-primary-500 text-primary-600 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">Account</a>
            <a href="#security" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">Security</a>
            <a href="#notifications" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">Notifications</a>
            <a href="#billing" class="border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">Billing</a>
        </nav>
    </div>

    <!-- Account Settings -->
    <div id="account" class="mb-10">
        <div class="bg-white shadow overflow-hidden sm:rounded-lg mb-6">
            <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                <h3 class="text-lg leading-6 font-medium text-gray-900">
                    Account Preferences
                </h3>
            </div>
            <div class="px-4 py-5 sm:p-6">
                <form method="post" action="{}">
                    {% csrf_token %}
                    <div class="space-y-4">
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="email_notifications" name="email_notifications" type="checkbox" 
                                       {% if preferences.email_notifications %}checked{% endif %}
                                       class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded">
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="email_notifications" class="font-medium text-gray-700">Email Notifications</label>
                                <p class="text-gray-500">Receive important account notifications via email</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="sms_notifications" name="sms_notifications" type="checkbox" 
                                       {% if preferences.sms_notifications %}checked{% endif %}
                                       class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded">
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="sms_notifications" class="font-medium text-gray-700">SMS Notifications</label>
                                <p class="text-gray-500">Receive urgent notifications via text message</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="newsletter" name="newsletter" type="checkbox" 
                                       {% if preferences.newsletter %}checked{% endif %}
                                       class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded">
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="newsletter" class="font-medium text-gray-700">Newsletter</label>
                                <p class="text-gray-500">Receive monthly updates and tips</p>
                            </div>
                        </div>
                        <div class="flex items-start">
                            <div class="flex items-center h-5">
                                <input id="maintenance_alerts" name="maintenance_alerts" type="checkbox" 
                                       {% if preferences.maintenance_alerts %}checked{% endif %}
                                       class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded">
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="maintenance_alerts" class="font-medium text-gray-700">Maintenance Alerts</label>
                                <p class="text-gray-500">Get notified about maintenance requests</p>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6">
                        <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                            Save Preferences
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div class="bg-white shadow overflow-hidden sm:rounded-lg">
            <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                <h3 class="text-lg leading-6 font-medium text-gray-900">
                    Language & Region
                </h3>
            </div>
            <div class="px-4 py-5 sm:p-6">
                <form method="post" action="{}">
                    {% csrf_token %}
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="language" class="block text-sm font-medium text-gray-700">Language</label>
                            <select id="language" name="language" 
                                    class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md">
                                <option value="en" {% if preferences.language == 'en' %}selected{% endif %}>English</option>
                                <option value="fr" {% if preferences.language == 'fr' %}selected{% endif %}>French</option>
                                <option value="es" {% if preferences.language == 'es' %}selected{% endif %}>Spanish</option>
                            </select>
                        </div>
                        <div>
                            <label for="timezone" class="block text-sm font-medium text-gray-700">Timezone</label>
                            <select id="timezone" name="timezone" 
                                    class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md">
                                <option value="UTC" {% if preferences.timezone == 'UTC' %}selected{% endif %}>UTC</option>
                                <option value="EST" {% if preferences.timezone == 'EST' %}selected{% endif %}>Eastern Time (EST)</option>
                                <option value="CST" {% if preferences.timezone == 'CST' %}selected{% endif %}>Central Time (CST)</option>
                                <option value="PST" {% if preferences.timezone == 'PST' %}selected{% endif %}>Pacific Time (PST)</option>
                            </select>
                        </div>
                    </div>
                    <div class="mt-6">
                        <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                            Update Settings
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Security Settings -->
    <div id="security" class="mb-10 hidden">
        <div class="bg-white shadow overflow-hidden sm:rounded-lg mb-6">
            <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                <h3 class="text-lg leading-6 font-medium text-gray-900">
                    Change Password
                </h3>
            </div>
            <div class="px-4 py-5 sm:p-6">
                <form method="post" action="{}">
                    {% csrf_token %}
                    <div class="space-y-4">
                        <div>
                            <label for="current_password" class="block text-sm font-medium text-gray-700">Current Password</label>
                            <div class="mt-1 relative">
                                <input id="current_password" name="current_password" type="password" required
                                       class="block w-full pr-10 shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm border-gray-300 rounded-md">
                                <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                    <button type="button" onclick="togglePassword('current_password')" class="text-gray-400 hover:text-gray-500">
                                        <i id="current_password-eye" class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div>
                            <label for="new_password" class="block text-sm font-medium text-gray-700">New Password</label>
                            <div class="mt-1 relative">
                                <input id="new_password" name="new_password" type="password" required
                                       class="block w-full pr-10 shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm border-gray-300 rounded-md">
                                <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                    <button type="button" onclick="togglePassword('new_password')" class="text-gray-400 hover:text-gray-500">
                                        <i id="new_password-eye" class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                            <p class="mt-1 text-xs text-gray-500">Must be at least 8 characters long</p>
                        </div>
                        <div>
                            <label for="confirm_password" class="block text-sm font-medium text-gray-700">Confirm New Password</label>
                            <div class="mt-1 relative">
                                <input id="confirm_password" name="confirm_password" type="password" required
                                       class="block w-full pr-10 shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm border-gray-300 rounded-md">
                                <div class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                    <button type="button" onclick="togglePassword('confirm_password')" class="text-gray-400 hover:text-gray-500">
                                        <i id="confirm_password-eye" class="fas fa-eye"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6">
                        <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                            Update Password
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <div class="bg-white shadow overflow-hidden sm:rounded-lg">
            <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                <h3 class="text-lg leading-6 font-medium text-gray-900">
                    Two-Factor Authentication
                </h3>
            </div>
            <div class="px-4 py-5 sm:p-6">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-900">Status: 
                            <span class="{% if two_factor_enabled %}text-green-600{% else %}text-yellow-600{% endif %}">
                                {% if two_factor_enabled %}Enabled{% else %}Disabled{% endif %}
                            </span>
                        </p>
                        <p class="text-sm text-gray-500 mt-1">
                            {% if two_factor_enabled %}
                            Two-factor authentication adds an extra layer of security to your account.
                            {% else %}
                            Add an extra layer of security to your account.
                            {% endif %}
                        </p>
                    </div>
                    {% if two_factor_enabled %}
                    <button type="button" class="inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                        Disable
                    </button>
                    {% else %}
                    <button type="button" class="inline-flex items-center px-3 py-1.5 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                        Enable
                    </button>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Settings -->
    <div id="notifications" class="mb-10 hidden">
        <div class="bg-white shadow overflow-hidden sm:rounded-lg">
            <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                <h3 class="text-lg leading-6 font-medium text-gray-900">
                    Notification Preferences
                </h3>
            </div>
            <div class="px-4 py-5 sm:p-6">
                <form method="post" action="{}">
                    {% csrf_token %}
                    <div class="space-y-6">
                        <div>
                            <h4 class="text-md font-medium text-gray-900 mb-3">Email Notifications</h4>
                            <div class="space-y-4">
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="rent_reminders" name="rent_reminders" type="checkbox" 
                                               {% if preferences.rent_reminders %}checked{% endif %}
                                               class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="rent_reminders" class="font-medium text-gray-700">Rent Reminders</label>
                                        <p class="text-gray-500">Receive reminders when rent is due</p>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="maintenance_updates" name="maintenance_updates" type="checkbox" 
                                               {% if preferences.maintenance_updates %}checked{% endif %}
                                               class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="maintenance_updates" class="font-medium text-gray-700">Maintenance Updates</label>
                                        <p class="text-gray-500">Get updates on maintenance requests</p>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="new_applications" name="new_applications" type="checkbox" 
                                               {% if preferences.new_applications %}checked{% endif %}
                                               class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="new_applications" class="font-medium text-gray-700">New Applications</label>
                                        <p class="text-gray-500">Be notified when you receive new applications</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="border-t border-gray-200 pt-6">
                            <h4 class="text-md font-medium text-gray-900 mb-3">Push Notifications</h4>
                            <div class="space-y-4">
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="urgent_alerts" name="urgent_alerts" type="checkbox" 
                                               {% if preferences.urgent_alerts %}checked{% endif %}
                                               class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="urgent_alerts" class="font-medium text-gray-700">Urgent Alerts</label>
                                        <p class="text-gray-500">Receive immediate alerts for urgent matters</p>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <div class="flex items-center h-5">
                                        <input id="payment_received" name="payment_received" type="checkbox" 
                                               {% if preferences.payment_received %}checked{% endif %}
                                               class="focus:ring-primary-500 h-4 w-4 text-primary-600 border-gray-300 rounded">
                                    </div>
                                    <div class="ml-3 text-sm">
                                        <label for="payment_received" class="font-medium text-gray-700">Payment Received</label>
                                        <p class="text-gray-500">Get notified when rent payments are received</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-6">
                        <button type="submit" class="inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                            Save Notification Settings
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Billing Settings -->
    <div id="billing" class="hidden">
        <div class="bg-white shadow overflow-hidden sm:rounded-lg">
            <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
                <h3 class="text-lg leading-6 font-medium text-gray-900">
                    Billing Information
                </h3>
            </div>
            <div class="px-4 py-5 sm:p-6">
                <div class="mb-6">
                    <h4 class="text-md font-medium text-gray-900 mb-3">Payment Methods</h4>
                    <div class="bg-gray-50 p-4 rounded-md">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <i class="fab fa-cc-visa text-3xl text-gray-400 mr-3"></i>
                                <div>
                                    <p class="text-sm font-medium text-gray-900">Visa ending in 4242</p>
                                    <p class="text-sm text-gray-500">Expires 04/2024</p>
                                </div>
                            </div>
                            <button class="text-sm text-red-600 hover:text-red-800">Remove</button>
                        </div>
                    </div>
                    <button class="mt-4 inline-flex items-center px-3 py-1.5 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                        <i class="fas fa-plus mr-2"></i> Add Payment Method
                    </button>
                </div>

                <div class="border-t border-gray-200 pt-6">
                    <h4 class="text-md font-medium text-gray-900 mb-3">Billing History</h4>
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Description</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount</th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th scope="col" class="relative px-6 py-3"></th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Jun 15, 2023</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Premium Subscription</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$9.99</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Paid</span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <a href="#" class="text-primary-600 hover:text-primary-900">View</a>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">May 15, 2023</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Premium Subscription</td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">$9.99</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">Paid</span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <a href="#" class="text-primary-600 hover:text-primary-900">View</a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Tab switching functionality
    document.querySelectorAll('[href^="#"]').forEach(tab => {
        tab.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            
            // Hide all content sections
            document.querySelectorAll('[id="account"], [id="security"], [id="notifications"], [id="billing"]').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Show selected section
            document.getElementById(targetId).classList.remove('hidden');
            
            // Update tab styling
            document.querySelectorAll('nav a').forEach(link => {
                link.classList.remove('border-primary-500', 'text-primary-600');
                link.classList.add('border-transparent', 'text-gray-500');
            });
            
            this.classList.remove('border-transparent', 'text-gray-500');
            this.classList.add('border-primary-500', 'text-primary-600');
        });
    });

    // Password toggle functionality
    function togglePassword(fieldId) {
        const field = document.getElementById(fieldId);
        const eyeIcon = document.getElementById(`${fieldId}-eye`);
        if (field.type === 'password') {
            field.type = 'text';
            eyeIcon.classList.remove('fa-eye');
            eyeIcon.classList.add('fa-eye-slash');
        } else {
            field.type = 'password';
            eyeIcon.classList.remove('fa-eye-slash');
            eyeIcon.classList.add('fa-eye');
        }
    }
</script>
{% endblock %}